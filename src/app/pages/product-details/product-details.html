<div>
  <div class="h-35">
    <a href="{{'/products/'+product.code}}">
      <img src="{{product.imageUrl}}"
           alt="{{product.name}}"
           class="h-30">
    </a>
  </div>

  <p-card class="card">
    <p-tabs value="0">
      <p-tablist>
        <p-tab value="0">Features</p-tab>
        <p-tab value="1">Releases</p-tab>
      </p-tablist>
      <p-tabpanels>
        <p-tabpanel value="0">
          <p-card class="p-5">
            <p-table [value]="features">
              <ng-template #caption>
                <div class="flex items-center justify-between">
                  <p-button class="font-bold"
                     *ngIf="authService.isLoggedIn()"
                     (click)="toggleCreateFeatureForm()"
                  > <span class="pi pi-plus-circle"></span> Feature</p-button>
                </div>
              </ng-template>
              <ng-template #header>
                <tr>
                  <th>Code</th>
                  <th>Title</th>
                  <th>Status</th>
                </tr>
              </ng-template>
              <ng-template #body let-feature>
                <tr>
                  <td>
                    <a routerLink="/products/{{product.code}}/features/{{feature.code}}"
                    >{{ feature.code }}</a>
                  </td>
                  <td>{{ feature.title }}</td>
                  <td>{{ feature.status }}</td>
                </tr>
              </ng-template>
            </p-table>
          </p-card>

          <p-card class="p-5" *ngIf="showCreateFeatureForm">
            <form [formGroup]="createFeatureForm" id="createFeatureForm" method="post" (ngSubmit)="handleCreateFeature()">
            <div class="card flex flex-col gap-4">
              <div class="font-semibold text-xl">Create Feature</div>
              <div class="flex flex-col gap-2">
                <label for="code">Code</label>
                <input pInputText id="code" type="text" formControlName="code"/>
              </div>
              <div class="flex flex-col gap-2">
                <label for="title">Title</label>
                <input pInputText id="title" type="text" formControlName="title"/>
              </div>
              <div class="flex flex-col gap-2">
                <label for="description">Description</label>
                <input pInputText id="description" type="text" formControlName="description"/>
              </div>
              <div class="flex flex-col gap-2">
                <label for="assignedTo">Assigned To</label>
                <input pInputText id="assignedTo" type="text" formControlName="assignedTo"/>
              </div>
              <div class="flex flex-col gap-2">
                <p-button label="Submit" [fluid]="false" type="submit"
                          [disabled]="createFeatureForm.invalid"
                          ></p-button>
              </div>
            </div>
            </form>
          </p-card>

        </p-tabpanel>

        <p-tabpanel value="1">
          <p-card class="p-5">
            <p-table [value]="releases" [tableStyle]="{ 'min-width': '50rem' }">
              <ng-template #caption>
                <div class="flex items-center justify-between">
                  <p-button class="font-bold"
                     *ngIf="authService.isLoggedIn()"
                     (click)="toggleCreateReleaseForm()"
                  ><span class="pi pi-plus-circle"></span>  Release</p-button>
                </div>
              </ng-template>
              <ng-template #header>
                <tr>
                  <th>Code</th>
                  <th>Description</th>
                  <th>Status</th>
                </tr>
              </ng-template>
              <ng-template #body let-release>
                <tr>
                  <td>
                    <a href="{{'/products/'+product.code+'/releases/'+release.code}}">{{ release.code }}</a>
                  </td>
                  <td>{{ release.description }}</td>
                  <td>{{ release.status }}</td>
                </tr>
              </ng-template>
            </p-table>
          </p-card>

          <p-card class="p-5" *ngIf="showCreateReleaseForm">
            <form [formGroup]="createReleaseForm" id="createReleaseForm" method="post" (ngSubmit)="handleCreateRelease()">
            <div class="card flex flex-col gap-4">
              <div class="font-semibold text-xl">Create Release</div>
              <div class="flex flex-col gap-2">
                <label for="code">Code</label>
                <input pInputText id="code" type="text" formControlName="code"/>
              </div>
              <div class="flex flex-col gap-2">
                <label for="description">Description</label>
                <input pInputText id="description" type="text" formControlName="description"/>
              </div>
              <div class="flex flex-col gap-2">
                <p-button label="Submit" [fluid]="false" type="submit"
                          [disabled]="createReleaseForm.invalid"></p-button>
              </div>
            </div>
            </form>
          </p-card>

        </p-tabpanel>
      </p-tabpanels>
    </p-tabs>
  </p-card>
</div>
